<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>KISSY plugins</title>
		<script src="http://g.tbcdn.cn/kissy/k/1.4.3/seed-min.js"></script>
		<script src="history.js"></script>
		<script src="router.js"></script>
	</head>
	<body>
	<div>
		<h1>测试 a 链接</h1>
		<ul>
			<li><a href="#/aaa?name=david&#38;age=27#abc">#/aaa?name=david&#38;age=27#abc</a></li>
			<li><a href="#/bbb">#/bbb</a></li>
			<li><a href="#/ccc?catid=222">#/ccc?catid=222</a></li>
			<li><a href="#/ddd">#/ddd</a></li>
			<li><a href="#/eee">#/eee</a></li>
			<li><a href="#/cat/124">#/cat/124</a></li>
			<li><a href="#/cat/photo">#/cat/photo</a></li>
		</ul>
	</div>
	<script>
	KISSY.use('router/m,history/m', function (S, router, history) {
		// history.addListener(function (newHash) {
		// 	console.log(newHash);
		// }).start();
		router
		.on('/aaa', function (path) {
			console.log(path);
		})
		.on('/bbb', function (path) {
			console.log('/bbb');
		})
		.on('/bbb', function (path) {
			console.log(path);
		})
		.on('/ccc', function (path) {
			console.log(path);
		})
		// 不支持可选，可选就用 querystring 的形式
		// .on('/items/:item(/:catname/:catid)', function (path, item, catname, catid) {
			
		// })
		.on('/cat/:id', [/\d+/], function (path, catId) {
			console.log('catId', path, catId);
		})
		.on('/cat/:name', [/[a-zA-Z]+/], function (path, catName) {
			console.log('catName', path, catName);
		})
		.on(/^\/cat\/(\d+)$/, function (path, catId) {
			console.log('reg catId', path, catId);
		})
		.on(/^\/eee$/, function (path) {
			console.log(path);
		})
		.otherwise(function (path) {
			console.log('otherwise',path);
			return {
				redirectTo: '/cat/123'
			}
			// router.navigate('/cat/123', false);
		});
		history.start();
	});
	</script>
	</body>
</html>